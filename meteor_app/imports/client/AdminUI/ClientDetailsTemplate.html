<template name="clientDetails">
    <div>
        <div class="panel panel-login scrollBox650 noBoxShadow">
            <div class="panel-body">
                <div class="row">
                    <div class="col-lg-12">
                        {{#unless Template.subscriptionsReady}}
                            <p style="color:lightgray; margin-top:1em">Loading...</p>
                        {{else}}
                            <h2> {{client.props.name}} </h2>
                            <br>
                            <div class="row">

                                <div class="col-md-12">
                                    <div class="pull-right">
                                        {{#if (checkAddMsgCreditsStatus 'idle')}}
                                            <a id="lnkAddMsgCredits" href="#" role="button" class="btn-login btn paddedBtn fullWidth">Add more credits</a>
                                        {{else if (checkAddMsgCreditsStatus 'data-enter')}}
                                            <input id="txiMsgCreditAmount" type="text" placeholder="Credit Amount"/>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <button id="butAddMsgCredits" class="btn-login btn fullWidth topMargin05">Add credit</button>
                                                </div>
                                                <div class="col-md-6">
                                                    <button id="lnkCancelAddMsgCredits" href="#" class="btn-login btn fullWidth topMargin05">Cancel</button>
                                                </div>
                                            </div>
                                        {{else if (checkAddMsgCreditsStatus 'processing')}}
                                            <span style="color:blue">Processing. Please wait...</span>
                                        {{else if (checkAddMsgCreditsStatus 'success')}}
                                            <span>Transaction complete, please wait for Confirmation</span>
                                            <br>
                                            <a id="lnkCancelAddMsgCredits" href="#" role="button" class="btn-login btn paddedBtn">Close</a>
                                        {{else if (checkAddMsgCreditsStatus 'error')}}
                                            <span style="color:red">{{addMsgCreditsError}}</span>
                                              <a id="lnkCancelAddMsgCredits" href="#" role="button" class="btn-login btn paddedBtn">Close</a>
                                        {{/if}}
                                    </div>
                                </div>
                            </div>
                            <br>


                            <div class="row">
                                <div class="col-lg-12">
                                    <!--<h2> Client Info </h2>-->
                                    <table class="table table-striped">
                                        <tbody>
                                        <tr>
                                            <td><label>Client&nbsp;ID:&nbsp;</label></td>
                                            <td>{{client.clientId}}</td>
                                        </tr>
                                        <tr>
                                            <td><label>Client&nbsp;Index:&nbsp;</label></td>
                                            <td>{{client.index.clientIndex}}</td>
                                        </tr>
                                        <tr>
                                            <td><label>Username:&nbsp;</label></td>
                                            <td>{{clientUsername client.user_id}}</td>
                                        </tr>
                                        <tr>
                                            <td><label>Message&nbsp;Credits:&nbsp;</label></td>
                                            <td>
                                                {{messageCredits.confirmed}}{{#if (hasUnconfirmedMessageCredits messageCredits)}}&nbsp;( + unconfirmed: <span style="color:red">{{messageCredits.unconfirmed}}</span>){{/if}}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><label> Meteor Account Status:</label></td>
                                            <td>
                                                {{userStatus client.user_id}}
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>

                                </div>
                            </div>
                            {{#if haveResentEnrollmentEmail}}
                            <div class="pull-left">
                                {{#if resendEnrollmentEmailSuccess}}
                                    <p> Successfully resent enrollment email</p>
                                {{else}}
                                    <!--this pops up first. need to have a "pending" element that shows that it's not an error-->
                                    <p> Wait, sending email. If this line persists, there is an error.</p>
                                {{/if}}
                            </div>
                            {{/if}}
                            <br>
                            <div class="row paddingTop40px">
                                <div class="col-md-4">
                                    <a href="#" id="resendEnrollmentEmail" role="button" class="btn-login btn paddedBtn fullWidth "> Resend Enrollment Mail</a>
                                </div>
                                <div class="col-md-4">
                                    {{#unless (userActive client.user_id)}}
                                        <a href="#" id="activateUser" role="button" class="btn-login btn paddedBtn fullWidth "> Activate User Account</a>
                                    {{else}}
                                        <a href="#" id="deactivateUser" role="button" class="btn-login btn paddedBtn fullWidth "> Deactivate User Account</a>
                                    {{/unless}}
                                    <!--also have a slot for incase the user is pending-->
                                </div>
                                <div class="col-md-4">
                                    {{#unless showDevices}}
                                            <a href="#" id="lnkShowDevices" role="button" class="btn-login btn paddedBtn fullWidth "> Show devices</a>
                                    {{else}}
                                            <a id="lnkHideDevices" href="#" role="button" class="btn-login btn paddedBtn fullWidth">Hide devices</a>
                                    {{/unless}}
                                </div>

                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-md-12">
                                    <div>
                                        {{#if showDevices}}
                                            {{#if client._id}}
                                                {{> devices client_id=client._id}}
                                            {{/if}}
                                        {{/if}}
                                    </div>
                                </div>
                            </div>
                        {{/unless}}
                        <div class="row">
                            <div class="col-md-6">
                                <a href="/admin/clients" role="button" class="btn-login btn paddedBtn fullWidth">Back to clients</a>
                            </div>
                            <div class="col-md-6">
                                <a href="/admin/newclient" role="button" class="btn-login btn paddedBtn fullWidth">Add another client</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>
