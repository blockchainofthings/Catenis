Catenis app database schema:

// NOTE: there should be one and only one document (record) for the Catenis collection
Application {
  _id: [string], // MongoDB internal document ID provided by Meteor
  seedHmac: [string],  // Base-64 formatted HMAC-SHA256 signature of a predefined text using the application seed as the key. This is used to validate the application seed
  lastBlockHeight: [number]  // Height of last blockchain block that has already been processed by the application
}

BitcoinFees {
  _id: [string],  / MongoDB internal document ID provided by Meteor
  recommended: {
    fastestFee: [integer],
    halfHourFee: [integer],
    hourFee: [integer]
  }
  list: {
    fees: [{
      minFee: [integer],
      maxFee: [integer],
      minDelay: [integer],
      maxDelay: [integer],
      minMinutes: [integer],
      maxMinutes: [integer]
    }]
  },
  createdDate: [date/time] // Date and time when doc/rec has been created
}

IssuedBlockchainAddress {
  _id: [string], // MongoDB internal document ID provided by Meteor
  type: [string],  // Name of address type (HD node extended key type)
  parentPath: [string],  // Path of the HD node from which this address is derived
  path: [string],  // The HD node path which identifies this address
  addrIndex: [integer],  // The position occupied by this address within the range of addresses of that type
  addressHash: [string],  // Base-64 formatted SHA256 hash of blockchain address
  issuedDate: [date/time],  // Date and time when address has been issued (doc/rec created)
  expirationDate: [date/time],  // Date and time until when this address is considered to be valid to receive payments
  status: [string],  // Valid values: 'new' (from creation util expiration date), 'expired' (after expiration date while there are UTXOs associated with it), 'obsolete' (after expiration date if there are no UTXOs associated with it), 'nonexistent' (address for given index does not exist), 'discarded' (excluded from current available range of addresses of that type)
  lastStatusChangedDate: [date/time]  // Date and time when status has been last modified
}

CatenisNode {
  _id: [string], // MongoDB internal document ID provided by Meteor
  type: [string],  // Identifies the type of Catenis node. Valid values: 'hub' (Catenis Hub node; cntNodeIndex = 0), 'gateway' (Catenis Gateway node; cntNodeIndex >= 1)
  ctnNodeIndex: [integer],  // HD node index associated with this Catenis node
  props: {
    name: [string],  // Catenis node name
    description: [string],  // Brief description of Catenis node's purpose
    lastModifiedDate: [date/time]  // Date and time when one of the Catenis node's properties had been last modified
  },
  status: [string],  // Valid values: 'active' (Catenis node is in normal use mode); 'deleted' (Catenis node has been logically deleted)
  createdDate: [date/time],  // Date and time when doc/rec has been created
  lastStatusChangedDate: [date/time], // Date and time when status has been last changed
  deletedDate: [date/time]  // Date and time when doc/rec has been marked as logically deleted
}

Client {
  _id: [string], // MongoDB internal document ID provided by Meteor
  user_id: [string],  // MongoDB internal ID of User doc/rec with which this client is associated
  catenisNode_id: [string],  // MongoDB internal ID of CatenisNode doc/rec with which this client is associated
  clientId: [string],  // External ID used to uniquely identify this client
  index: {  // This composite field should be a unique ID
    ctnNodeIndex: [integer],  // HD node index associated with the Catenis node with which this client is associated
    clientIndex: [integer]  // HD node index associated with this client
  },
  props: {
    name: [string],  // Client name
    lastModifiedDate: [date/time]  // Date and time when one of the client's properties had been last modified
  },
  apiAccessGenKey: [string],  // Key used to generate default secret key used for client's devices to access the Catenis API
  status: [string],  // Valid values: 'new' (newly created client awaiting activation); 'active' (client is in normal use mode); 'deleted' (client has been logically deleted)
  createdDate: [date/time],  // Date and time when doc/rec has been created
  lastStatusChangedDate: [date/time], // Date and time when status has been last changed
  lastApiAccessGenKeyModifiedDate: [date/time], // date and time when API access generator key has been last modified
  _deleted: {  // Used to record the latest state of fields that are somehow changed once the doc/rec is marked as logically deleted. This field shall only exist while the doc/rec is logically deleted
    user_id: [string],  // The original field should be removed
    status: [string]  // The original field should have its value changed to 'deleted'
    deletedDate: [date/time]  // Date and time when doc/rec has been marked as logically deleted
  }
}

ServiceCredit {
  _id: [string], // MongoDB internal document ID provided by Meteor
  client_id: [string], // MongoDB internal ID of Client doc/rec with which this service credit entry is associated
  srvCreditType: [string],  // Valid values: 'message' - message credit; 'asset' - asset credit
  fundingTx: {
    txid: [string],  // Blockchain attributed ID (hash) of funding transaction used to provision client service credit
    confirmed: [boolean]  // Indicates whether funding transaction has already been confirmed
  },
  initCredits: [integer],  // Number of credits initially given
  remainCredits: [integer],  // Number of credits remaining (not yet used)
  createdDate: [date/time],  // Date and time when doc/rec has been created (credits initially given)
  lastCreditUpdatedDate: [date/time]  // Date and time when remaining credits has been last updated
} 

Device {
  _id: [string], // MongoDB internal document ID provided by Meteor
  client_id: [string],  // MongoDB internal ID of Client doc/rec with which this device is associated
  deviceId: [string],  // External ID used to uniquely identify this device
  index: {  // This composite field should be a unique ID
    ctnNodeIndex: [integer],  // HD node index associated with the Catenis node with which the client is associated
    clientIndex: [integer],  // HD node index associated with the client with which this device is associated
    deviceIndex: [integer]  // HD node index associated with this client's device 
  },
  props: {
    name: [string],  // Device name
    prodUniqueId: [string],  // Proprietary ID that uniquely identifies the client's physical device/product that is associated to this logical device
    public: [boolean],  // (optional) Indicates that the main properties of this device (name and prodUniqueId) can be disclosed
    lastModifiedDate: [date/time]  // Date and time when one of the device's properties had been last modified
  },
  apiAccessGenKey: [string],  // Key used to generate secret key used for accessing the Catenis API. If set to null, should use Client's default API access key
  status: [string],  // Valid values: 'new' (newly created device awaiting activation - funding of device's main/asset addresses have not started (due to lack of system funds)); 'pending' (awaiting confirmation of funding of device's main/asset addresses); 'active' (device in normal use mode - after device's main/asset addresses have been funded); 'inactive' (disabled device - device has been put temporarily out of use); 'deleted' (device has been logically deleted)
  createdDate: [date/time],  // Date and time when doc/rec was created
  lastStatusChangedDate: [date/time], // Date and time when status has been last changed
  lastApiAccessGenKeyModifiedDate: [date/time], // Date and time when API access generator key has been last modified
  _deleted: {  // Used to record the latest state of fields that are somehow changed once the doc/rec is marked as logically deleted. This field shall only exist while the doc/rec is logically deleted
    prodUniqueId: [string],  // The original field should be removed
    status: [string], // The original field should have its value changed to 'deleted'
    deletedDate: [date/time]  // Date and time when doc/rec has been marked as logically deleted
  }
}

Message {
  _id: [string],  // MongoDB internal document ID provided by Meteor
  messageId: [string],  // External ID used to uniquely identify this message
  action: [string],   // Identifies the action performed on the message. Valid values (from Message.action): 'log', 'send'
  source: [string],  // Identifies if this is a message that had been issued by this Catenis node (value = 'local') or by another Catenis node (value = 'remote')
  originDeviceId: [string],  // External ID of the device that logged/sent the message
  targetDeviceId: [string],  // External ID of the device to which message had been sent. This field should only be present for sent messages (action = 'send')
  readConfirmationEnabled: [boolean],  // Indicates whether message was sent with read confirmation enabled. This field should only be present for sent messages (action = 'send')
  isEncrypted: [boolean],   // Indicates whether stored message is encrypted
  blockchain: {
    txid: [string],  // Blockchain attributed ID (hash) of transaction created to record the message
    confirmed: [boolean]  // Indicates whether transaction created to record the message has already been confirmed
  },
  externalStorage: {
    provider: [string],  // Name of external storage provider that was used to store message
    reference: [string]  // Reference to message in the external storage
  },
  createdDate: [date/time],  // Date and time when doc/rec has been created
  sentDate: [date/time],  // Date and time when message has been sent. This field is only available for 'local' messages
  receivedDate: [date/time],  // Date and time when message has been received. This field only exists for 'send' messages after they had actually been received.
  blocked: [boolean],  // Identifies a 'send' message that should have been received but instead had been blocked (due to the intended receiving device not being active or its permission setting). Note that this field should never exist along with the receivedDate field; only one of these fields should exist for a given Message doc (for 'send' message after it had been received/blocked). Also, if present, this field should always have the value true
  firstReadDate: [date/time],  // Date and time when message has first been read (by the device that logged it, or by its intended receiver in case of a 'send' message)
                               //  NOTE: this field is available for both 'local' and 'remote' messages, and only once the message has been read at least once.
                               //   However, for 'local' messages sent to a remote Catenis node, it shall only be available if the message had read confirmation enabled and the target device allows for message read notification.
  lastReadDate: [date/time],  // Date and time when message has last been read (by the device that logged it, or by its intended receiver in case of a 'send' message)
                              //  NOTE: this field is available for both 'local' and 'remote' messages, and only once the message has been read at least once.
                              //    However, it is not available for 'local' messages sent to a remote Catenis node
  readConfirmed: [boolean]  // Indicates that a read confirmation had already been received for this message. This field should only exist (with the value true) for messages that had read confirmation enabled and after a read confirmation had been received
}

SentTransaction {
  _id: [string], // MongoDB internal document ID provided by Meteor
  type: [string], // Identifies the type of transaction that was sent. Valid values (from Catenis.Transaction.type): 'funding', 'send_message', 'log_message', 'read_confirmation', 'issue_locked_asset', 'issue_unlocked_asset', 'transfer_asset'
  txid: [string], // Blockchain attributed ID (hash) of the sent transaction
  sentDate: [date/time], // Date and time when transaction was sent to the blockchain network
  confirmation: {
    confirmed: [boolean], // Indicates whether this transaction has already been confirmed within the blockchain
    blockHash: [string], // Hash (ID) of blockchain block that contains this transaction
    confirmationDate: [date/time], // Date and time when transaction has been confirmed. This is derived from the block time
  },
  replacedByTxid: [string], // Blockchain attributed ID (hash) of the transaction that replaces (by means of the RBF - Replace By Fee feature) this transaction (which in turn shall never make to the blockchain and thus shall never be confirmed). This is primarily intended for transactions of the 'read_confirmation' type. This field should only exist if the transaction has been replaced, and it will be set to null to indicate that the transaction that it replaced (directly or indirectly via its descendants) had actually been confirmed later
  info: {  // Specific information about the transaction according to its type
    funding: {  // Information for funding transactions
      event: {
        name: [string], // Identifies the event that triggered the funding action. Valid values (from Catenis.FundTransaction.fundingEvent): 'provision_system_device', 'provision_client_srv_credit', 'provision_client_device', 'add_extra_tx_pay_funds'
        entityId: [string] // Id of the entity associated with the event. Should only exist for 'provision_client_srv_credit' and 'provision_client_device' events. For 'provision_client_srv_credit' events, it refers to the clientId; for 'provision_client_device' events, it refers to the deviceId
      },
      payees: [Array(string)] // Identifies the type of blockchain addresses that receive the funds. Valid values (from Catenis.KeyStore.extKeyType): 'ctnd_dev_main_addr', 'ctnd_pay_tx_exp_addr', 'cln_msg_crd_addr', 'cln_asst_crd_addr', 'dev_main_addr', 'dev_asst_issu_addr'
    },
    sendMessage: { // Information for send message transactions
      originDeviceId: [string], // External ID of the device that sent the message
      targetDeviceId: [string], // External ID of the device that receives the message
      readConfirmation: {  // This field should only exist for messages sent with read confirmation enabled
        vout: [integer] // The index of the output within this transaction that is used for read confirmation
      }
    },
    logMessage: { // Information for log message transactions
      deviceId: [string] // External ID of the device that logged the message
    },
    readConfirmation: {
      serializedTx: {   // Object from serialized tx minus useOptInRBF and txid properties
        inputs: [{
          txid: [string],    // Blockchain assigned ID of transaction containing output that is spent by this input
          vout: [number],    // Index which identifies the output that is spent by this input
          amount: [number],  // Amount, in satoshis, associated with the output that is spent by this input
          addrPath: [string] // HD node path of the blockchain address associated with the output that is spent by this input
        }],
        outputs: [{
          type: [string],           // Identifies the type of the output. Either: 'P2PKH', 'P2SH'
          addrPath: [string],       // HD node path of the blockchain address to where payment should be sent
          amount: [number],         // Amount, in satoshis, to send
        }]
      },
      spentReadConfirmTxOutCount: [number]  // Number of send message tx read confirmation address outputs that had been spent by this tx
    },
    issueLockedAsset: {
      assetId: [string], // ID that uniquely identifies the Colored Coins asset that is issued
      deviceId: [string] // External ID of the device that is issuing the asset
    },
    issueUnlockedAsset: {
      assetId: [string], // ID that uniquely identifies the coloredCoin asset that is issued
      deviceId: [string] // External ID of the device that is issuing the asset
    },
    transferAsset: {
      assetId: [string], // ID that uniquely identifies the Colored Coins asset that is transferred
      originDeviceId: [string], // External ID of the device that sent the assets
      targetDeviceId: [string] // External ID of the device that receives the assets
    }
  },
  originalTxid: [string]  // Blockchain attributed ID (hash) that had been originally assigned to the transaction. If this field exists, it means that this transaction's ID had been modified due to malleability, and the txid field has the modified tx id.
}

ReceivedTransaction {
  _id: [string], // MongoDB internal document ID provided by Meteor
  type: [string], // Identifies the type of transaction that was received. Valid values (from Catenis.Transaction.type): 'sys_funding', 'send_message', 'read_confirmation', 'transfer_asset'
  txid: [string], // Blockchain attributed ID (hash) of the received transaction
  receivedDate: [date/time], // Date and time when transaction was received. This is derived from timereceived property returned by gettransaction RPC method
  sentTransaction_id: [string], // MongoDB internal ID of SentTransaction doc/rec which corresponds to this transaction. This field should be filled (exist) for all received transactions that have been sent by this Catenis node. Note that for transactions of the 'sys_funding' type this field must never be filled (exist) since those types of transactions are not sent by the system
  confirmation: {   // This field should only exist for received transaction that are not associated with a sent transaction (field sentTransaction_id non-existent)
    confirmed: [boolean], // Indicates whether this transaction has already been confirmed within the blockchain
    blockHash: [string], // Hash (ID) of blockchain block that contains this transaction
    confirmationDate: [date/time] // Date and time when transaction has been confirmed. This is derived from the block time
  },
  info: {  // Specific information about the transaction according to its type.
    sysFunding: {
      fundAddresses: [{ // List identifying the Catenis system funding addresses through which funds have been received
        path: [string],     // HD node path of the address
        amount: [number]    // Amount, in satoshis, of funds paid to the specified address
    }],
    sendMessage: { // Information for send message transactions
      originDeviceId: [string], // External ID of the device that sent the message
      targetDeviceId: [string], // External ID of the device that receives the message
      readConfirmation: {   // This field should only exist for messages that had been sent with read confirmation enabled
        vout: [integer], // The index of the output within this transaction that is used for read confirmation
        spent: [boolean] // Indicates whether the read confirmation output has already been spent by a transaction (of the 'read_confirmation' type)
      }
    },
    readConfirmation: {
      spentReadConfirmTxOuts: [{ // Identifies the read confirmation tx outputs that are spent by this transaction
        txid: [string], // Blockchain attributed ID of the transaction containing the read confirmation output that is spent
        vout: [integer] // The index of the output within the transaction that is spent
      }]
    },
    transferAsset: {
      assetId: [string], // ID that uniquely identifies the Colored Coins asset that is transferred
      originDeviceId: [string], // External ID of the device that sent the assets
      targetDeviceId: [string] // External ID of the device that receives the assets
    }
  },
  originalTxid: [string]  // Blockchain attributed ID (hash) that had been originally assigned to the transaction. If this field exists, it means that this transaction's ID had been modified due to malleability, and the txid field has the modified tx id.
}

Malleability {
  _id: [string], // MongoDB internal document ID provided by Meteor
  source: [string],  // Source (from Catenis node's point of view) of transaction the txid of which got changed due to malleability. Valid values: 'sent_tx', 'received_tx'
  originalTxid: [string],  // Original blockchain attributed ID (hash) of the transaction
  modifiedTxid: [string],  // New blockchain attributed ID (hash) of transaction due to malleability
  createdDate: [date/time]  // Date and time when record has been created
}

Permission {
   _id: [string], // MongoDB internal document ID provided by Meteor
   event: [string], // Name of event for which permission is being defined. Valid values (from Permission.event): 'receive_notify_new_msg', 'receive_notify_msg_read', 'send_read_msg_confirm', 'receive_msg'
   subjectEntityType: [string],  // The type of the subject entity: either 'client' or 'device'
   subjectEntityId: [string], // ID of device that functions as the subject of the action associated with the event for which permission is being defined (subjectEntityType = 'device'),
                              //  or ID of client for which default permission for all its devices is being set (subjectEntityType = 'client')
   level: [string], // Designates upon which devices the permission right should be applied. Valid values (from Permission.level): '1.device', '2.client', '3.catenis_node', '4.system'
   objectEntityId: [string], // Identifies the device that functions as the object of the action associated with the event and upon which the permission right should be applied
                             //  If level = 'device', it should contain a device ID, and the permission right applies to a given device.
                             //  If level = 'client', it should contain a client ID, and the permission right applies to any devices that belongs to that client.
                             //  If level = 'catenisNode', it should contain a Catenis Node index, and the permission right applies to any devices that belong to any clients that pertain to that Catenis node.
                             //  If level = 'system', this field should not exist, and the permission right applies to any devices
   right: [string]  // The permission right that should be applied: allow, deny
}